<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Login ‚Äî Fullstack Gym</title>

  <!-- Bootstrap kept for layout utilities (optional) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{
      --bg1: #0f0f12;
      --bg2: #0b1226;
      --accent: #d4af37;
      --card: rgba(255,255,255,0.04);
      --glass-border: rgba(255,255,255,0.06);
      --muted: rgba(255,255,255,0.55);
      --success: #2ecc71;
      --danger: #ff6b6b;
      --glass-blur: 10px;
      --radius: 14px;
    }

    /* Page layout */
    html,body { height:100%; margin:0; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background: radial-gradient(1200px 600px at 10% 20%, rgba(212,175,55,0.06), transparent), linear-gradient(160deg, var(--bg1), var(--bg2)); color:#f5f5f5; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }

    /* floating decorative blobs */
    .blob {
      position: fixed;
      border-radius: 48%;
      filter: blur(36px);
      opacity:.55;
      transform: translateZ(0);
      pointer-events:none;
      z-index:0;
      mix-blend-mode:screen;
      animation: floaty 10s ease-in-out infinite;
    }
    .blob.b1 { width:480px;height:300px; left:-120px; top:-50px; background: linear-gradient(90deg, rgba(212,175,55,.14), rgba(80,60,120,.08)); animation-duration:14s;}
    .blob.b2 { width:360px;height:260px; right:-80px; bottom:-60px; background: linear-gradient(120deg, rgba(200,120,255,.06), rgba(40,120,255,.06)); animation-duration:18s; animation-delay: -2s; }
    @keyframes floaty { 0% { transform: translateY(0) rotate(0deg);} 50% { transform: translateY(-36px) rotate(6deg);} 100% { transform: translateY(0) rotate(0deg);} }

    /* center wrapper */
    .wrap {
      min-height:100dvh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 32px;
      position:relative;
      z-index:1;
    }

    /* login card */
    .card-glass {
      width:100%;
      max-width:480px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid var(--glass-border);
      border-radius: var(--radius);
      box-shadow: 0 12px 40px rgba(2,6,23,0.65);
      backdrop-filter: blur(var(--glass-blur));
      padding:2.2rem;
      transform: translateY(12px) scale(.995);
      opacity:0;
      animation: cardIn .6s cubic-bezier(.2,.9,.3,1) forwards .18s;
    }
    @keyframes cardIn { to { transform:none; opacity:1;} }

    /* logo */
    .logo-wrap { display:flex; justify-content:center; margin-bottom:.6rem; }
    .logo {
      width:96px; height:96px; border-radius:50%;
      display:inline-grid; place-items:center;
      background: linear-gradient(180deg, rgba(255,255,255,.9), rgba(255,255,255,.85));
      padding:8px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.5), inset 0 -6px 12px rgba(0,0,0,.08);
      transform-origin:center;
      animation: logoPop .9s cubic-bezier(.2,.9,.3,1) forwards;
    }
    .logo img { width:100%; height:100%; object-fit:cover; border-radius:50%; display:block; }
    @keyframes logoPop { 0% { transform: scale(.6) rotate(-6deg); opacity:0; } 60% { transform: scale(1.06) rotate(4deg); } 100% { transform: scale(1) rotate(0deg); opacity:1; } }

    h3.title {
      text-align:center; margin:0 0 .6rem 0; font-family: Georgia, "Times New Roman", Times, serif; letter-spacing:.6px;
      color: #fff; font-weight:600;
    }
    p.lead { text-align:center; margin:0 0 1rem 0; color:var(--muted); font-size:.95rem }

    /* inputs: floating label style */
    .form-field { position:relative; margin-bottom:1.15rem; }
    .form-field input {
      width:100%;
      background: transparent;
      border: 1px solid rgba(255,255,255,0.06);
      padding: .92rem .9rem .92rem 3.6rem;
      border-radius:10px;
      color: #fff;
      outline:none;
      transition: box-shadow .22s ease, border-color .18s ease, transform .18s;
    }
    .form-field input:focus { border-color: rgba(212,175,55,.95); box-shadow: 0 6px 22px rgba(212,175,55,0.08); transform: translateY(-2px); }

    .form-field label {
      position:absolute; left: 3.6rem; top: 50%; transform: translateY(-50%);
      color: var(--muted); pointer-events:none; font-size:.9rem; transition: all .18s ease;
    }
    .form-field input:focus + label,
    .form-field input:not(:placeholder-shown) + label {
      top:10%; transform: translateY(0); font-size:.75rem; color: var(--accent);
    }

    /* icon inside input */
    .icon {
      position:absolute; left:12px; top:50%; transform:translateY(-50%); opacity:.9; font-size:1.06rem; color:var(--accent);
      display:flex; align-items:center; justify-content:center;
      width:28px; height:28px;
    }

    /* primary button with sheen */
    .btn-primary {
      background: linear-gradient(180deg, var(--accent), #c79a2e);
      border: none; color:#0b0b0b; font-weight:700;
      padding:.75rem .9rem; border-radius:10px;
      box-shadow: 0 10px 30px rgba(212,175,55,0.12);
      position:relative; overflow:hidden;
    }
    .btn-primary::after {
      content:""; position:absolute; left:-50%; top:0; width:40%; height:100%;
      background: linear-gradient(90deg, rgba(255,255,255,0.24), rgba(255,255,255,0.06));
      transform: skewX(-12deg) translateX(-24%); transition: transform .65s cubic-bezier(.2,.9,.3,1);
    }
    .btn-primary:hover::after { transform: skewX(-12deg) translateX(200%); }
    .btn-primary:active { transform:translateY(1px); box-shadow:none; }

    /* small link row */
    .help-row { display:flex; justify-content:space-between; align-items:center; margin-top:.6rem; font-size:.9rem; color:var(--muted); }
    .help-row a { color:var(--muted); text-decoration:none; }
    .help-row a:hover { color:var(--accent); text-decoration:underline; }

    /* alerts (used by your JS into #message) */
    #message .alert { margin-bottom:0; border-radius:8px; box-shadow: 0 8px 20px rgba(0,0,0,0.45); opacity:0; transform: translateY(6px); animation: alertIn .45s forwards; }
    @keyframes alertIn { to { opacity:1; transform:none; } }
    .alert-success { background: linear-gradient(90deg, rgba(46,204,113,.12), rgba(46,204,113,.06)); border-color: rgba(46,204,113,.12); color: #cfffe2; }
    .alert-danger { background: linear-gradient(90deg, rgba(255,107,107,.08), rgba(255,107,107,.03)); border-color: rgba(255,107,107,.08); color: #ffdede; }

    /* small responsive tweak */
    @media (max-width:520px){
      .card-glass { padding:1.6rem; border-radius:12px; }
      .logo { width:80px;height:80px; }
      .form-field input { padding-left:3.2rem; }
    }

    /* hide focus outline unless keyboard nav */
    :focus { outline: none; }
    :focus-visible { outline: 3px solid rgba(212,175,55,.14); outline-offset:3px; border-radius:8px; }

    /* modal - CSS only - using checkbox hack */
    .modal-toggle { display:none; }
    .modal-layer {
      position:fixed; inset:0; display:grid; place-items:center; z-index:2000;
      background: rgba(2,4,8,0.6); opacity:0; pointer-events:none; transition:opacity .18s ease;
    }
    .modal-box {
      width:min(720px,92%); background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px; padding:1.4rem; border:1px solid rgba(255,255,255,0.04); box-shadow: 0 24px 60px rgba(0,0,0,0.65);
      color: #fff;
    }
    /* show when checked */
    .modal-toggle:checked + .modal-layer { opacity:1; pointer-events:auto; }

    .modal-actions { display:flex; gap:.6rem; justify-content:flex-end; margin-top:1rem; }
    .modal-actions .btn { border-radius:10px; }

    .form-field {
  position: relative;
  margin-bottom: 25px;
}

.form-field .icon {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 1.2rem;
  color: #555;
}

.form-field input {
  padding-left: 42px !important;
}

  </style>
</head>
<body>

  <!-- decorative blobs -->
  <div class="blob b1"></div>
  <div class="blob b2"></div>

  <main class="wrap">
    <div class="card-glass">

      <div class="logo-wrap">
        <div class="logo" aria-hidden="true">
          <!-- use your logo.png; fallback to initials if missing -->
          <img src="logo.png" alt="Fullstack Gym logo" onerror="this.style.opacity=.02; this.style.background='linear-gradient(180deg,#fff,#ddd)';">
        </div>
      </div>

      <h3 class="title">Welcome back</h3>
      <p class="lead">Sign in to access your classes & membership dashboard</p>

      <!-- form begins -->
      <form id="login-form" autocomplete="on" novalidate>
        <div id="message" class="mb-3" aria-live="polite"></div>

        <div class="form-field">
  <i class="bi bi-envelope icon"></i>
  <input id="mail" name="mail" type="email" placeholder=" " required />
  <label for="mail">Email address</label>
</div>

<div class="form-field">
  <i class="bi bi-lock-fill icon"></i>
  <input id="password" name="password" type="password" placeholder=" " required />
  <label for="password">Password</label>
</div>


        <div class="d-grid">
          <button type="submit" class="btn btn-primary">Sign in</button>
        </div>

        <div class="help-row">
          <div>
            <label for="modalToggle" style="cursor:pointer; color:var(--muted);">Forgot password?</label>
            <!-- the label toggles the checkbox -->
          </div>
          <div>
            <a href="register.html">Create account</a>
          </div>
        </div>

      </form>
      <!-- form ends -->

    </div>
  </main>

  <!-- CSS-only modal (checkbox) -->
  <input id="modalToggle" class="modal-toggle" type="checkbox" />
  <div class="modal-layer" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal-box" role="document">
      <h4 id="modalTitle">Reset password</h4>
      <p style="color:var(--muted); margin-top:.4rem;">Enter your registered email on the reset page. We‚Äôll send a one-time link to set a new password.</p>
      <div style="margin-top:.9rem;">
        <a href="register.html" class="btn btn-outline-light">Visit support</a>
        <label for="modalToggle" class="btn btn-primary" style="margin-left:.6rem">Close</label>
      </div>
    </div>
  </div>

  <!-- keep your original script and server call; preserved and minimally adjusted -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const loginForm = document.getElementById('login-form');
    const messageDiv = document.getElementById('message');

    loginForm.addEventListener('submit', async (event) => {
      event.preventDefault();

      // We use the ID 'mail' but send it as 'email' to match backend
      const email = document.getElementById('mail').value;
      const password = document.getElementById('password').value;

      messageDiv.innerHTML = '';
      messageDiv.className = '';

      try {
        // NOTE: When you deploy, change localhost to your Render URL
        const response = await fetch('https://fullstackgym.onrender.com/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password }) 
        });

        const data = await response.json();

        if (response.ok) {
          messageDiv.innerHTML = `<div class="alert alert-success">‚úîÔ∏è ${data.message}</div>`;
          
          // === CRITICAL: SAVE THE TOKEN ===
          localStorage.setItem('token', data.token);
          localStorage.setItem('userEmail', data.email);

          setTimeout(() => {
            window.location.href = 'index.html';
          }, 900);
        } else {
          messageDiv.innerHTML = `<div class="alert alert-danger">‚úñ ${data.message}</div>`;
        }
      } catch (error) {
        console.error('Login Error:', error);
        messageDiv.innerHTML = `<div class="alert alert-danger">Cannot connect to server. Check if Node is running.</div>`;
      }
    });
</script>

<div id="server-toast" style="
    position: fixed; 
    bottom: 20px; 
    right: 20px; 
    background: #333; 
    color: #fff; 
    padding: 15px 25px; 
    border-left: 5px solid #d4af37; 
    border-radius: 4px; 
    box-shadow: 0 4px 12px rgba(0,0,0,0.3); 
    z-index: 9999; 
    font-family: sans-serif;
    max-width: 300px;
    animation: slideIn 0.5s ease-out forwards;
">
    <h5 style="margin: 0 0 5px 0; color: #d4af37;">üöÄ Free Tier Server</h5>
    <p style="margin: 0; font-size: 0.9rem;">
        The backend sleeps when inactive. The first request may take <strong>50-60 seconds</strong> to wake it up. Please be patient!
    </p>
    <button onclick="document.getElementById('server-toast').style.display='none'" style="
        position: absolute; 
        top: 5px; 
        right: 10px; 
        background: none; 
        border: none; 
        color: #888; 
        cursor: pointer; 
        font-size: 1.2rem;
    ">&times;</button>
</div>

<style>
    @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
</style>

<script>
    // Optional: Hide automatically after 10 seconds
    setTimeout(() => {
        const toast = document.getElementById('server-toast');
        if (toast) toast.style.display = 'none';
    }, 15000);
</script>
</body>
</html>
